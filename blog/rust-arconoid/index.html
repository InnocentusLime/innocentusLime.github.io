




<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8" />
        <meta name="generator" content="Zola 0.19.2">
        <meta name="author" content="Innokentii (InnocentusLime) Meleshchenko">
        <link rel="license" href="https:&#x2F;&#x2F;creativecommons.org&#x2F;licenses&#x2F;by&#x2F;4.0&#x2F;">
        <title>Simple Arcanoid That Runs On Mobile</title>

        <!-- Preloads -->
        <link rel="preload" as="image" href="/img/decor/site-border.svg">
        <link rel="preload" as="image" href="/img/decor/site-bot-border-decor.svg">
        <link rel="preload" as="image" href="/img/decor/site-top-border-decor.svg">

        <!-- Css stuff -->
        <link rel="preload" as="style" href="/css/normalize.css">
        <link rel="stylesheet" href="/css/normalize.css">
        <link rel="preload" as="style" href="/css/style.css">
        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/highlight.css">

        <!-- Look okay on mobile pls -->
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- OpenGraph -->
        <meta property="og:title" content="Simple Arcanoid That Runs On Mobile" />
        <meta property="og:description" content="Macroquad is a very nice variable for writing games! But have you ever tried writing a game in it that works both on Desktop and mobile... In a browser?" />
        <meta property="og:url" content="https://innocentuslime.github.io/" />
        <meta property="og:site_name" content="InnocentusLime's page"/>

        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary" />
        <meta property="twitter:domain" content="innocentuslime.github.io" />
        <meta property="twitter:url" content="https://innocentuslime.github.io/" />
        <meta name="twitter:title" content="Simple Arcanoid That Runs On Mobile" />
        <meta name="twitter:description" content="Macroquad is a very nice variable for writing games! But have you ever tried writing a game in it that works both on Desktop and mobile... In a browser?" />
    </head>
    <body>
        
                
                    
<header class="site-header">
    <nav>
        <ul class="nav-items">
            
            
                

<li class="nav-item">
    <a class="nav-link" href=&#x2F;>
        about&nbsp;me
    </a>
</li>

            
                

<li class="nav-item">
    <a class="nav-link 

active" href=&#x2F;blog>
        blog
    </a>
</li>

            
                

<li class="nav-item">
    <a class="nav-link" href=&#x2F;project>
        projects
    </a>
</li>

            
        </ul>
    </nav>
    <ul class="social-items">
        
        
            
            <li class="social-item"><a class="social-link" href=https:&#x2F;&#x2F;x.com&#x2F;InnocentusLime&#x2F;>
                <img class="social-image" src=/img/social/x.svg alt="X logo"/>
            </a></li>
        
            
            <li class="social-item"><a class="social-link" href=https:&#x2F;&#x2F;itch.io&#x2F;profile&#x2F;innocentuslime&#x2F;>
                <img class="social-image" src=/img/social/itch-io.svg alt="itch.io logo"/>
            </a></li>
        
            
            <li class="social-item"><a class="social-link" href=https:&#x2F;&#x2F;www.reddit.com&#x2F;user&#x2F;Innocentuslime&#x2F;>
                <img class="social-image" src=/img/social/reddit.svg alt="Reddit logo"/>
            </a></li>
        
    </ul>
</header>

                
        
        
    <main class="article">
    <h2 id="introduction"><a class="zola-anchor" href="#introduction" aria-label="Anchor link for: introduction">Introduction</a></h2>
<p><code>macroquad</code> is a library for developing games. It has a remarkably simple API and a decent cross-platform support. There is an <a href="https://mq.agical.se/">amazing tutorial</a> on how to write the game with it. In addition to this, there is an <a href="https://mq.agical.se/release-web.html">excellent section</a> on shipping your game in <code>WebAssembly</code>. Is it possible to make a <code>macroquad</code> application that is compiled into <code>WebAssembly</code>, that works both on PC and mobile?</p>
<p>If you browse <a href="https://macroquad.rs/examples/">the examples</a>, hosted on the macroquad website -- you will find that they work on <code>WebAssembly</code> supporting mobile devices without any problems at a quite comfortable FPS. Some examples that do not require keyboard input can even be interacted with. However, these are just application examples. This blogpost is about <code>Boring Arcanoid</code> -- a simple arcanoid clone written with <code>macroquad</code> that can be played <strong>both</strong> on phones and PCs.</p>
<p>The application is a single standalone <code>WebAssembly</code> module, that detects the platform it is run on at runtime and adjusts the controls and ui accordingly. Essentially, that means that a game written this way can be effortlessly served through a super simple static HTTP server. Thus, making it a perfect for uploading such games to websites like <code>itch.io</code>!</p>
<h2 id="miniquad-plugin-api"><a class="zola-anchor" href="#miniquad-plugin-api" aria-label="Anchor link for: miniquad-plugin-api">Miniquad plugin API</a></h2>
<p>At the current moment a lot of browser API is not available in <code>WebAssembly</code>. This is circumvented by providing what is needed with "import objects"<sup class="footnote-reference"><a href="#1">1</a></sup>. In fact <code>macroquad</code> and <code>miniquad</code> do just that to import the WebGL API functions.</p>
<p>However, if we were to just use that import object to sneak in the OpenGL functions -- <code>miniquad</code> and <code>macroquad</code> applications would be quite hard to extend. Crates like <code>quad_snd</code> would not be possible. For this reason <code>miniquad</code> has a plugin API, which is described in detail on <code>macroquad</code> website <a href="https://macroquad.rs/articles/wasm/">here</a>. The gist of it is as follows</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">miniquad_add_plugin</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">register_plugin</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-variable z-other z-readwrite z-ts">reg_function</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">on_init</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-variable z-other z-readwrite z-ts">init_func</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">name</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>Plugin name<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">version</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-variable z-other z-constant z-ts">VERSION_NUM</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre>
<p>The exported API should be put into the import object with <code>reg_function</code> and all the plugin state (on the JS side) should initialized with <code>init_func</code>. With this API, I was able to add some functions that would allow me to implement the cross-platform arcanoid.</p>
<h2 id="the-extra-api"><a class="zola-anchor" href="#the-extra-api" aria-label="Anchor link for: the-extra-api">The extra API</a></h2>
<p>To facilitate the mobile device support, the following functions would be needed: getting the device orientations and checking if the current device is a mobile device in the first place. The orientation checking<sup class="footnote-reference"><a href="#2">2</a></sup> is needed to prompt the user to rotate their mobile device (explicitly asking the device to enter a certain orientation is not baseline API at the moment<sup class="footnote-reference"><a href="#3">3</a></sup>). Detecting if the device is a mobile device or not is not an existing API either. However, it is possible to figure this out by checking the user agent string<sup class="footnote-reference"><a href="#4">4</a></sup></p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-definition z-function z-ts"><span class="z-entity z-name z-function z-ts">app_is_on_mobile</span></span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts">    <span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">let</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">check</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-boolean z-false z-ts">false</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts">    <span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">a</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-keyword z-control z-conditional z-ts">if</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-regexp z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">/</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>android<span class="z-keyword z-operator z-or z-regexp">|</span>bb<span class="z-constant z-other z-character-class z-regexp">\d</span><span class="z-keyword z-operator z-quantifier z-regexp">+</span><span class="z-keyword z-operator z-or z-regexp">|</span>meego<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-constant z-other z-character-class z-regexp">.</span><span class="z-keyword z-operator z-quantifier z-regexp">+</span>mobile<span class="z-keyword z-operator z-or z-regexp">|</span>avantgo<span class="z-keyword z-operator z-or z-regexp">|</span>bada<span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-keyword z-operator z-or z-regexp">|</span>blackberry<span class="z-keyword z-operator z-or z-regexp">|</span>blazer<span class="z-keyword z-operator z-or z-regexp">|</span>compal<span class="z-keyword z-operator z-or z-regexp">|</span>elaine<span class="z-keyword z-operator z-or z-regexp">|</span>fennec<span class="z-keyword z-operator z-or z-regexp">|</span>hiptop<span class="z-keyword z-operator z-or z-regexp">|</span>iemobile<span class="z-keyword z-operator z-or z-regexp">|</span>ip<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>hone<span class="z-keyword z-operator z-or z-regexp">|</span>od<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>iris<span class="z-keyword z-operator z-or z-regexp">|</span>kindle<span class="z-keyword z-operator z-or z-regexp">|</span>lge <span class="z-keyword z-operator z-or z-regexp">|</span>maemo<span class="z-keyword z-operator z-or z-regexp">|</span>midp<span class="z-keyword z-operator z-or z-regexp">|</span>mmp<span class="z-keyword z-operator z-or z-regexp">|</span>mobile<span class="z-constant z-other z-character-class z-regexp">.</span><span class="z-keyword z-operator z-quantifier z-regexp">+</span>firefox<span class="z-keyword z-operator z-or z-regexp">|</span>netfront<span class="z-keyword z-operator z-or z-regexp">|</span>opera m<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ob<span class="z-keyword z-operator z-or z-regexp">|</span>in<span class="z-punctuation z-definition z-group z-regexp">)</span></span>i<span class="z-keyword z-operator z-or z-regexp">|</span>palm<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span> os<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-quantifier z-regexp">?</span><span class="z-keyword z-operator z-or z-regexp">|</span>phone<span class="z-keyword z-operator z-or z-regexp">|</span>p<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ixi<span class="z-keyword z-operator z-or z-regexp">|</span>re<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-keyword z-operator z-or z-regexp">|</span>plucker<span class="z-keyword z-operator z-or z-regexp">|</span>pocket<span class="z-keyword z-operator z-or z-regexp">|</span>psp<span class="z-keyword z-operator z-or z-regexp">|</span>series<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>4<span class="z-keyword z-operator z-or z-regexp">|</span>6<span class="z-punctuation z-definition z-group z-regexp">)</span></span>0<span class="z-keyword z-operator z-or z-regexp">|</span>symbian<span class="z-keyword z-operator z-or z-regexp">|</span>treo<span class="z-keyword z-operator z-or z-regexp">|</span>up<span class="z-constant z-character z-escape z-backslash z-regexp">\.</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>browser<span class="z-keyword z-operator z-or z-regexp">|</span>link<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>vodafone<span class="z-keyword z-operator z-or z-regexp">|</span>wap<span class="z-keyword z-operator z-or z-regexp">|</span>windows ce<span class="z-keyword z-operator z-or z-regexp">|</span>xda<span class="z-keyword z-operator z-or z-regexp">|</span>xiino<span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">i</span></span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">test</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">a</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-keyword z-operator z-logical z-ts">||</span><span class="z-string z-regexp z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">/</span>1207<span class="z-keyword z-operator z-or z-regexp">|</span>6310<span class="z-keyword z-operator z-or z-regexp">|</span>6590<span class="z-keyword z-operator z-or z-regexp">|</span>3gso<span class="z-keyword z-operator z-or z-regexp">|</span>4thp<span class="z-keyword z-operator z-or z-regexp">|</span>50<span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">1-6</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span>i<span class="z-keyword z-operator z-or z-regexp">|</span>770s<span class="z-keyword z-operator z-or z-regexp">|</span>802s<span class="z-keyword z-operator z-or z-regexp">|</span>a wa<span class="z-keyword z-operator z-or z-regexp">|</span>abac<span class="z-keyword z-operator z-or z-regexp">|</span>ac<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>er<span class="z-keyword z-operator z-or z-regexp">|</span>oo<span class="z-keyword z-operator z-or z-regexp">|</span>s<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>ai<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ko<span class="z-keyword z-operator z-or z-regexp">|</span>rn<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>al<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>av<span class="z-keyword z-operator z-or z-regexp">|</span>ca<span class="z-keyword z-operator z-or z-regexp">|</span>co<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>amoi<span class="z-keyword z-operator z-or z-regexp">|</span>an<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ex<span class="z-keyword z-operator z-or z-regexp">|</span>ny<span class="z-keyword z-operator z-or z-regexp">|</span>yw<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>aptu<span class="z-keyword z-operator z-or z-regexp">|</span>ar<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ch<span class="z-keyword z-operator z-or z-regexp">|</span>go<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>as<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>te<span class="z-keyword z-operator z-or z-regexp">|</span>us<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>attw<span class="z-keyword z-operator z-or z-regexp">|</span>au<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>di<span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>m<span class="z-keyword z-operator z-or z-regexp">|</span>r <span class="z-keyword z-operator z-or z-regexp">|</span>s <span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>avan<span class="z-keyword z-operator z-or z-regexp">|</span>be<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ck<span class="z-keyword z-operator z-or z-regexp">|</span>ll<span class="z-keyword z-operator z-or z-regexp">|</span>nq<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>bi<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>lb<span class="z-keyword z-operator z-or z-regexp">|</span>rd<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>bl<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ac<span class="z-keyword z-operator z-or z-regexp">|</span>az<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>br<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>e<span class="z-keyword z-operator z-or z-regexp">|</span>v<span class="z-punctuation z-definition z-group z-regexp">)</span></span>w<span class="z-keyword z-operator z-or z-regexp">|</span>bumb<span class="z-keyword z-operator z-or z-regexp">|</span>bw<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>n<span class="z-keyword z-operator z-or z-regexp">|</span>u<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>c55<span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-keyword z-operator z-or z-regexp">|</span>capi<span class="z-keyword z-operator z-or z-regexp">|</span>ccwa<span class="z-keyword z-operator z-or z-regexp">|</span>cdm<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>cell<span class="z-keyword z-operator z-or z-regexp">|</span>chtm<span class="z-keyword z-operator z-or z-regexp">|</span>cldc<span class="z-keyword z-operator z-or z-regexp">|</span>cmd<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>co<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>mp<span class="z-keyword z-operator z-or z-regexp">|</span>nd<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>craw<span class="z-keyword z-operator z-or z-regexp">|</span>da<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>it<span class="z-keyword z-operator z-or z-regexp">|</span>ll<span class="z-keyword z-operator z-or z-regexp">|</span>ng<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>dbte<span class="z-keyword z-operator z-or z-regexp">|</span>dc<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>s<span class="z-keyword z-operator z-or z-regexp">|</span>devi<span class="z-keyword z-operator z-or z-regexp">|</span>dica<span class="z-keyword z-operator z-or z-regexp">|</span>dmob<span class="z-keyword z-operator z-or z-regexp">|</span>do<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>c<span class="z-keyword z-operator z-or z-regexp">|</span>p<span class="z-punctuation z-definition z-group z-regexp">)</span></span>o<span class="z-keyword z-operator z-or z-regexp">|</span>ds<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>12<span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>d<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>el<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>49<span class="z-keyword z-operator z-or z-regexp">|</span>ai<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>em<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>l2<span class="z-keyword z-operator z-or z-regexp">|</span>ul<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>er<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ic<span class="z-keyword z-operator z-or z-regexp">|</span>k0<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>esl8<span class="z-keyword z-operator z-or z-regexp">|</span>ez<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">4-7</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span>0<span class="z-keyword z-operator z-or z-regexp">|</span>os<span class="z-keyword z-operator z-or z-regexp">|</span>wa<span class="z-keyword z-operator z-or z-regexp">|</span>ze<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>fetc<span class="z-keyword z-operator z-or z-regexp">|</span>fly<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>_<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>g1 u<span class="z-keyword z-operator z-or z-regexp">|</span>g560<span class="z-keyword z-operator z-or z-regexp">|</span>gene<span class="z-keyword z-operator z-or z-regexp">|</span>gf<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>5<span class="z-keyword z-operator z-or z-regexp">|</span>g<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>mo<span class="z-keyword z-operator z-or z-regexp">|</span>go<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\.</span>w<span class="z-keyword z-operator z-or z-regexp">|</span>od<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>gr<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ad<span class="z-keyword z-operator z-or z-regexp">|</span>un<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>haie<span class="z-keyword z-operator z-or z-regexp">|</span>hcit<span class="z-keyword z-operator z-or z-regexp">|</span>hd<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>m<span class="z-keyword z-operator z-or z-regexp">|</span>p<span class="z-keyword z-operator z-or z-regexp">|</span>t<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>hei<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>hi<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>pt<span class="z-keyword z-operator z-or z-regexp">|</span>ta<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>hp<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span> i<span class="z-keyword z-operator z-or z-regexp">|</span>ip<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>hs<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>c<span class="z-keyword z-operator z-or z-regexp">|</span>ht<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>c<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span> <span class="z-keyword z-operator z-or z-regexp">|</span>_<span class="z-keyword z-operator z-or z-regexp">|</span>a<span class="z-keyword z-operator z-or z-regexp">|</span>g<span class="z-keyword z-operator z-or z-regexp">|</span>p<span class="z-keyword z-operator z-or z-regexp">|</span>s<span class="z-keyword z-operator z-or z-regexp">|</span>t<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>tp<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>hu<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>aw<span class="z-keyword z-operator z-or z-regexp">|</span>tc<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>i<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>20<span class="z-keyword z-operator z-or z-regexp">|</span>go<span class="z-keyword z-operator z-or z-regexp">|</span>ma<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>i230<span class="z-keyword z-operator z-or z-regexp">|</span>iac<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span> <span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>ibro<span class="z-keyword z-operator z-or z-regexp">|</span>idea<span class="z-keyword z-operator z-or z-regexp">|</span>ig01<span class="z-keyword z-operator z-or z-regexp">|</span>ikom<span class="z-keyword z-operator z-or z-regexp">|</span>im1k<span class="z-keyword z-operator z-or z-regexp">|</span>inno<span class="z-keyword z-operator z-or z-regexp">|</span>ipaq<span class="z-keyword z-operator z-or z-regexp">|</span>iris<span class="z-keyword z-operator z-or z-regexp">|</span>ja<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>t<span class="z-keyword z-operator z-or z-regexp">|</span>v<span class="z-punctuation z-definition z-group z-regexp">)</span></span>a<span class="z-keyword z-operator z-or z-regexp">|</span>jbro<span class="z-keyword z-operator z-or z-regexp">|</span>jemu<span class="z-keyword z-operator z-or z-regexp">|</span>jigs<span class="z-keyword z-operator z-or z-regexp">|</span>kddi<span class="z-keyword z-operator z-or z-regexp">|</span>keji<span class="z-keyword z-operator z-or z-regexp">|</span>kgt<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span> <span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>klon<span class="z-keyword z-operator z-or z-regexp">|</span>kpt <span class="z-keyword z-operator z-or z-regexp">|</span>kwc<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>kyo<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>c<span class="z-keyword z-operator z-or z-regexp">|</span>k<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>le<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>no<span class="z-keyword z-operator z-or z-regexp">|</span>xi<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>lg<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span> g<span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>k<span class="z-keyword z-operator z-or z-regexp">|</span>l<span class="z-keyword z-operator z-or z-regexp">|</span>u<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>50<span class="z-keyword z-operator z-or z-regexp">|</span>54<span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">a-w</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>libw<span class="z-keyword z-operator z-or z-regexp">|</span>lynx<span class="z-keyword z-operator z-or z-regexp">|</span>m1<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>w<span class="z-keyword z-operator z-or z-regexp">|</span>m3ga<span class="z-keyword z-operator z-or z-regexp">|</span>m50<span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-keyword z-operator z-or z-regexp">|</span>ma<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>te<span class="z-keyword z-operator z-or z-regexp">|</span>ui<span class="z-keyword z-operator z-or z-regexp">|</span>xo<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>mc<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>01<span class="z-keyword z-operator z-or z-regexp">|</span>21<span class="z-keyword z-operator z-or z-regexp">|</span>ca<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>m<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>cr<span class="z-keyword z-operator z-or z-regexp">|</span>me<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>rc<span class="z-keyword z-operator z-or z-regexp">|</span>ri<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>mi<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>o8<span class="z-keyword z-operator z-or z-regexp">|</span>oa<span class="z-keyword z-operator z-or z-regexp">|</span>ts<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>mmef<span class="z-keyword z-operator z-or z-regexp">|</span>mo<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>01<span class="z-keyword z-operator z-or z-regexp">|</span>02<span class="z-keyword z-operator z-or z-regexp">|</span>bi<span class="z-keyword z-operator z-or z-regexp">|</span>de<span class="z-keyword z-operator z-or z-regexp">|</span>do<span class="z-keyword z-operator z-or z-regexp">|</span>t<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span> <span class="z-keyword z-operator z-or z-regexp">|</span>o<span class="z-keyword z-operator z-or z-regexp">|</span>v<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>zz<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>mt<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>50<span class="z-keyword z-operator z-or z-regexp">|</span>p1<span class="z-keyword z-operator z-or z-regexp">|</span>v <span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>mwbp<span class="z-keyword z-operator z-or z-regexp">|</span>mywa<span class="z-keyword z-operator z-or z-regexp">|</span>n10<span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">0-2</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>n20<span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">2-3</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>n30<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>0<span class="z-keyword z-operator z-or z-regexp">|</span>2<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>n50<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>0<span class="z-keyword z-operator z-or z-regexp">|</span>2<span class="z-keyword z-operator z-or z-regexp">|</span>5<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>n7<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>0<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>0<span class="z-keyword z-operator z-or z-regexp">|</span>1<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>10<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>ne<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>c<span class="z-keyword z-operator z-or z-regexp">|</span>m<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>on<span class="z-keyword z-operator z-or z-regexp">|</span>tf<span class="z-keyword z-operator z-or z-regexp">|</span>wf<span class="z-keyword z-operator z-or z-regexp">|</span>wg<span class="z-keyword z-operator z-or z-regexp">|</span>wt<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>nok<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>6<span class="z-keyword z-operator z-or z-regexp">|</span>i<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>nzph<span class="z-keyword z-operator z-or z-regexp">|</span>o2im<span class="z-keyword z-operator z-or z-regexp">|</span>op<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ti<span class="z-keyword z-operator z-or z-regexp">|</span>wv<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>oran<span class="z-keyword z-operator z-or z-regexp">|</span>owg1<span class="z-keyword z-operator z-or z-regexp">|</span>p800<span class="z-keyword z-operator z-or z-regexp">|</span>pan<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>a<span class="z-keyword z-operator z-or z-regexp">|</span>d<span class="z-keyword z-operator z-or z-regexp">|</span>t<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>pdxg<span class="z-keyword z-operator z-or z-regexp">|</span>pg<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>13<span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">1-8</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>c<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>phil<span class="z-keyword z-operator z-or z-regexp">|</span>pire<span class="z-keyword z-operator z-or z-regexp">|</span>pl<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ay<span class="z-keyword z-operator z-or z-regexp">|</span>uc<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>pn<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>2<span class="z-keyword z-operator z-or z-regexp">|</span>po<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ck<span class="z-keyword z-operator z-or z-regexp">|</span>rt<span class="z-keyword z-operator z-or z-regexp">|</span>se<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>prox<span class="z-keyword z-operator z-or z-regexp">|</span>psio<span class="z-keyword z-operator z-or z-regexp">|</span>pt<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>g<span class="z-keyword z-operator z-or z-regexp">|</span>qa<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>a<span class="z-keyword z-operator z-or z-regexp">|</span>qc<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>07<span class="z-keyword z-operator z-or z-regexp">|</span>12<span class="z-keyword z-operator z-or z-regexp">|</span>21<span class="z-keyword z-operator z-or z-regexp">|</span>32<span class="z-keyword z-operator z-or z-regexp">|</span>60<span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">2-7</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>i<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>qtek<span class="z-keyword z-operator z-or z-regexp">|</span>r380<span class="z-keyword z-operator z-or z-regexp">|</span>r600<span class="z-keyword z-operator z-or z-regexp">|</span>raks<span class="z-keyword z-operator z-or z-regexp">|</span>rim9<span class="z-keyword z-operator z-or z-regexp">|</span>ro<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ve<span class="z-keyword z-operator z-or z-regexp">|</span>zo<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>s55<span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-keyword z-operator z-or z-regexp">|</span>sa<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ge<span class="z-keyword z-operator z-or z-regexp">|</span>ma<span class="z-keyword z-operator z-or z-regexp">|</span>mm<span class="z-keyword z-operator z-or z-regexp">|</span>ms<span class="z-keyword z-operator z-or z-regexp">|</span>ny<span class="z-keyword z-operator z-or z-regexp">|</span>va<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sc<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>01<span class="z-keyword z-operator z-or z-regexp">|</span>h<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>oo<span class="z-keyword z-operator z-or z-regexp">|</span>p<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sdk<span class="z-constant z-character z-escape z-backslash z-regexp">\/</span><span class="z-keyword z-operator z-or z-regexp">|</span>se<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>c<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>0<span class="z-keyword z-operator z-or z-regexp">|</span>1<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>47<span class="z-keyword z-operator z-or z-regexp">|</span>mc<span class="z-keyword z-operator z-or z-regexp">|</span>nd<span class="z-keyword z-operator z-or z-regexp">|</span>ri<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sgh<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>shar<span class="z-keyword z-operator z-or z-regexp">|</span>sie<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>m<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sk<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>0<span class="z-keyword z-operator z-or z-regexp">|</span>sl<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>45<span class="z-keyword z-operator z-or z-regexp">|</span>id<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sm<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>al<span class="z-keyword z-operator z-or z-regexp">|</span>ar<span class="z-keyword z-operator z-or z-regexp">|</span>b3<span class="z-keyword z-operator z-or z-regexp">|</span>it<span class="z-keyword z-operator z-or z-regexp">|</span>t5<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>so<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>ft<span class="z-keyword z-operator z-or z-regexp">|</span>ny<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sp<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>01<span class="z-keyword z-operator z-or z-regexp">|</span>h<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>v<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>v <span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>sy<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>01<span class="z-keyword z-operator z-or z-regexp">|</span>mb<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>t2<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>18<span class="z-keyword z-operator z-or z-regexp">|</span>50<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>t6<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>00<span class="z-keyword z-operator z-or z-regexp">|</span>10<span class="z-keyword z-operator z-or z-regexp">|</span>18<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>ta<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>gt<span class="z-keyword z-operator z-or z-regexp">|</span>lk<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>tcl<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>tdg<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>tel<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>i<span class="z-keyword z-operator z-or z-regexp">|</span>m<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>tim<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>t<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>mo<span class="z-keyword z-operator z-or z-regexp">|</span>to<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>pl<span class="z-keyword z-operator z-or z-regexp">|</span>sh<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>ts<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>70<span class="z-keyword z-operator z-or z-regexp">|</span>m<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>m3<span class="z-keyword z-operator z-or z-regexp">|</span>m5<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>tx<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>9<span class="z-keyword z-operator z-or z-regexp">|</span>up<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\.</span>b<span class="z-keyword z-operator z-or z-regexp">|</span>g1<span class="z-keyword z-operator z-or z-regexp">|</span>si<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>utst<span class="z-keyword z-operator z-or z-regexp">|</span>v400<span class="z-keyword z-operator z-or z-regexp">|</span>v750<span class="z-keyword z-operator z-or z-regexp">|</span>veri<span class="z-keyword z-operator z-or z-regexp">|</span>vi<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>rg<span class="z-keyword z-operator z-or z-regexp">|</span>te<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>vk<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>40<span class="z-keyword z-operator z-or z-regexp">|</span>5<span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">0-3</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-keyword z-operator z-or z-regexp">|</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span>v<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>vm40<span class="z-keyword z-operator z-or z-regexp">|</span>voda<span class="z-keyword z-operator z-or z-regexp">|</span>vulc<span class="z-keyword z-operator z-or z-regexp">|</span>vx<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>52<span class="z-keyword z-operator z-or z-regexp">|</span>53<span class="z-keyword z-operator z-or z-regexp">|</span>60<span class="z-keyword z-operator z-or z-regexp">|</span>61<span class="z-keyword z-operator z-or z-regexp">|</span>70<span class="z-keyword z-operator z-or z-regexp">|</span>80<span class="z-keyword z-operator z-or z-regexp">|</span>81<span class="z-keyword z-operator z-or z-regexp">|</span>83<span class="z-keyword z-operator z-or z-regexp">|</span>85<span class="z-keyword z-operator z-or z-regexp">|</span>98<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>w3c<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span> <span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>webc<span class="z-keyword z-operator z-or z-regexp">|</span>whit<span class="z-keyword z-operator z-or z-regexp">|</span>wi<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>g <span class="z-keyword z-operator z-or z-regexp">|</span>nc<span class="z-keyword z-operator z-or z-regexp">|</span>nw<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-keyword z-operator z-or z-regexp">|</span>wmlb<span class="z-keyword z-operator z-or z-regexp">|</span>wonu<span class="z-keyword z-operator z-or z-regexp">|</span>x700<span class="z-keyword z-operator z-or z-regexp">|</span>yas<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-keyword z-operator z-or z-regexp">|</span>your<span class="z-keyword z-operator z-or z-regexp">|</span>zeto<span class="z-keyword z-operator z-or z-regexp">|</span>zte<span class="z-constant z-character z-escape z-backslash z-regexp">\-</span><span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">i</span></span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">test</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">a</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">substr</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">0</span><span class="z-punctuation z-separator z-comma z-ts">,</span><span class="z-constant z-numeric z-decimal z-ts">4</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-variable z-other z-readwrite z-ts">check</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-boolean z-true z-ts">true</span><span class="z-punctuation z-terminator z-statement z-ts">;</span><span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-support z-variable z-dom z-ts">navigator</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">userAgent</span><span class="z-keyword z-operator z-logical z-ts">||</span><span class="z-support z-variable z-dom z-ts">navigator</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">vendor</span><span class="z-keyword z-operator z-logical z-ts">||</span><span class="z-support z-variable z-dom z-ts">window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">opera</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts">        <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-readwrite z-ts">check</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-definition z-function z-ts"><span class="z-entity z-name z-function z-ts">app_get_orientation</span></span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts">    <span class="z-switch-statement z-expr z-ts"><span class="z-switch-expression z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">switch</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-support z-variable z-dom z-ts">screen</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-object z-property z-ts">orientation</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">type</span><span class="z-meta z-brace z-round z-ts">)</span></span> <span class="z-switch-block z-expr z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">case</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>landscape-primary<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">        <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-constant z-numeric z-decimal z-ts">0</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">case</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>landscape-secondary<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">        <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-constant z-numeric z-decimal z-ts">180</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">case</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>portrait-secondary<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">        <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-keyword z-operator z-arithmetic z-ts">-</span><span class="z-constant z-numeric z-decimal z-ts">90</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">case</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>portrait-primary<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">        <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-constant z-numeric z-decimal z-ts">90</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">default</span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">        <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-constant z-numeric z-decimal z-ts">0</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-switch-statement z-expr z-ts"><span class="z-switch-block z-expr z-ts">    </span><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre>
<p>With this in-place, the functions were imported into the Rust code for later calling as follows</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-storage z-type z-module z-rust">mod</span> <span class="z-entity z-name z-module z-rust">imports</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-other z-rust">extern</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>C<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">app_is_on_mobile</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">bool</span></span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">app_get_orientation</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">f32</span></span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">on_mobile</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">bool</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">unsafe</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-meta z-path z-rust">imports<span class="z-punctuation z-accessor z-rust">::</span></span>app_is_on_mobile<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">get_orientation</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">f32</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">unsafe</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-meta z-path z-rust">imports<span class="z-punctuation z-accessor z-rust">::</span></span>app_get_orientation<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>To make the application also work on native platforms, I simply added the no-op implementations</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">on_mobile</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">bool</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-constant z-language z-rust">false</span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">get_orientation</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">f32</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h2 id="why-the-re-orientation"><a class="zola-anchor" href="#why-the-re-orientation" aria-label="Anchor link for: why-the-re-orientation">Why the re-orientation</a></h2>
<p>I have designed the arcanoid application in such a way, that it does not fit well into a portrait style orientation. While designing the app -- there were two routes I could take when implementing mobile support:</p>
<ul>
<li>Rotate the rendered graphics automatically</li>
<li>Just expect the device to be in landscape mode</li>
</ul>
<p>When considering what route to take -- I decided that expecting the landscape mode is the best route for the following reasons:</p>
<ul>
<li>Touch position handling looks clean</li>
<li>There is no extra code in the rendering system</li>
<li>Redesigning for portrait mode equals extra problems</li>
<li>It is common to play games with your phone in landscape mode</li>
<li>Other route would undermine the idea of "it just works everywhere"</li>
</ul>
<h2 id="handling-user-input"><a class="zola-anchor" href="#handling-user-input" aria-label="Anchor link for: handling-user-input">Handling user input</a></h2>
<p>Now, having the API for platform specific stuff -- an abstraction is required. In case of a <code>macroquad</code> game -- what needs to be done is to abstract away the input code. Platform specific wise it is as follows:</p>
<ul>
<li>On desktop -- we use <code>A</code> and <code>D</code> to move the arcanoid paddle</li>
<li>On mobile -- we use on-screen buttons to move the paddle</li>
</ul>
<p>For that I have written the <code>Ui</code> struct in the <code>ui.rs</code> module. It is responsible for reading the user input and (if needed) draw the controls on the screen. The input requests are encoded as a bunch of flags like that:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Clone<span class="z-punctuation z-separator z-rust">,</span> Copy<span class="z-punctuation z-separator z-rust">,</span> Debug</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">InGameUiModel</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">left_movement_down</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-storage z-type z-rust">bool</span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">right_movement_down</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-storage z-type z-rust">bool</span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>And when it comes to reading the input, the following method does the trick</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">update</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> InGameUiModel</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Macroquad allows to get touch position with mouse_position
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>mx<span class="z-punctuation z-separator z-rust">,</span> my</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-function z-rust">mouse_position</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> Vec2 <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> x<span class="z-punctuation z-separator z-rust">:</span> mx<span class="z-punctuation z-separator z-rust">,</span> y<span class="z-punctuation z-separator z-rust">:</span> my </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_cam</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">screen_to_world</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">vec2</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>mx<span class="z-punctuation z-separator z-rust">,</span> my</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> left_button_rect <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">move_left_button_rect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> right_button_rect <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">move_right_button_rect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> left_movement_down <span class="z-keyword z-operator z-assignment z-rust">=</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-function z-rust">is_key_down</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">KeyCode<span class="z-punctuation z-accessor z-rust">::</span></span>A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">||</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-function z-rust">is_key_down</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">KeyCode<span class="z-punctuation z-accessor z-rust">::</span></span>Left</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">||</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>left_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">contains</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">vec2</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>mx<span class="z-punctuation z-separator z-rust">,</span> my</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">&amp;&amp;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">            <span class="z-support z-function z-rust">is_mouse_button_down</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">MouseButton<span class="z-punctuation z-accessor z-rust">::</span></span>Left</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">&amp;&amp;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">            <span class="z-support z-function z-rust">on_mobile</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> right_movement_down <span class="z-keyword z-operator z-assignment z-rust">=</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-function z-rust">is_key_down</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">KeyCode<span class="z-punctuation z-accessor z-rust">::</span></span>D</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">||</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-function z-rust">is_key_down</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">KeyCode<span class="z-punctuation z-accessor z-rust">::</span></span>Right</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">||</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>right_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">contains</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">vec2</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>mx<span class="z-punctuation z-separator z-rust">,</span> my</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">&amp;&amp;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">            <span class="z-support z-function z-rust">is_mouse_button_down</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">MouseButton<span class="z-punctuation z-accessor z-rust">::</span></span>Left</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">&amp;&amp;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">            <span class="z-support z-function z-rust">on_mobile</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    InGameUiModel <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        left_movement_down<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        right_movement_down<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>And then inside the <code>Ui::draw()</code> method I just did this</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">draw</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span><span class="z-variable z-parameter z-rust">self</span>, <span class="z-variable z-parameter z-rust">model</span><span class="z-punctuation z-separator z-rust">:</span> InGameUiModel</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-function z-rust">set_camera</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span><span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_cam</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> <span class="z-keyword z-operator z-logical z-rust">!</span><span class="z-support z-function z-rust">on_mobile</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-keyword z-control z-rust">return</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> left_button_rect <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">move_left_button_rect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> right_button_rect <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">move_right_button_rect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-function z-rust">draw_rectangle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        left_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>x<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        left_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>y<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        left_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>w<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        left_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>h<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        <span class="z-keyword z-control z-rust">if</span> model<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">move_left</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-constant z-other z-rust">WHITE</span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        <span class="z-keyword z-control z-rust">else</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-meta z-path z-rust">Color<span class="z-punctuation z-accessor z-rust">::</span></span>from_hex<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-hexadecimal z-rust">0xDDFBFF</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-function z-rust">draw_rectangle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        right_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>x<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        right_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>y<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        right_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>w<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        right_button_rect<span class="z-punctuation z-accessor z-dot z-rust">.</span>h<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        <span class="z-keyword z-control z-rust">if</span> model<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">move_right</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-constant z-other z-rust">WHITE</span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">        <span class="z-keyword z-control z-rust">else</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-meta z-path z-rust">Color<span class="z-punctuation z-accessor z-rust">::</span></span>from_hex<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-hexadecimal z-rust">0xDDFBFF</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h2 id="requesting-reorientation"><a class="zola-anchor" href="#requesting-reorientation" aria-label="Anchor link for: requesting-reorientation">Requesting reorientation</a></h2>
<p>As it has been been made clear before, it is not possible to make any mobile device change its orientation<sup class="footnote-reference"><a href="#3">3</a></sup>. That is why we need to <strong>ask</strong> the user to do that instead. It is more or less simple to implement. We just check the device orientation every frame and if it is misoriented -- we enter a "please rotate" state, where game logic does not run.</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"> <span class="z-keyword z-control z-rust">if</span> <span class="z-support z-function z-rust">get_orientation</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-comparison z-rust">!=</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span> <span class="z-keyword z-operator z-logical z-rust">&amp;&amp;</span> state <span class="z-keyword z-operator z-comparison z-rust">!=</span> <span class="z-meta z-path z-rust">GameState<span class="z-punctuation z-accessor z-rust">::</span></span>PleaseRotate <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    prev_state <span class="z-keyword z-operator z-assignment z-rust">=</span> state<span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    state <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">GameState<span class="z-punctuation z-accessor z-rust">::</span></span>PleaseRotate<span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-keyword z-control z-rust">match</span> state <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">GameState<span class="z-punctuation z-accessor z-rust">::</span></span>Active <span class="z-keyword z-operator z-rust">=&gt;</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">/*</span> Game logic <span class="z-punctuation z-definition z-comment z-rust">*/</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">GameState<span class="z-punctuation z-accessor z-rust">::</span></span>PleaseRotate <span class="z-keyword z-control z-rust">if</span> <span class="z-support z-function z-rust">get_orientation</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-comparison z-rust">==</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span> <span class="z-keyword z-operator z-rust">=&gt;</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        state <span class="z-keyword z-operator z-assignment z-rust">=</span> prev_state<span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-rust">_</span> <span class="z-keyword z-operator z-rust">=&gt;</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></code></pre>
<h2 id="conclusion"><a class="zola-anchor" href="#conclusion" aria-label="Anchor link for: conclusion">Conclusion</a></h2>
<p><code>WebAssembly</code> is fun and writing games is fun too. I am really happy with how relatively clean the code turned out. There are certainly several extra things to explore!</p>
<p>First of all, I should try uploading the game in <code>itch.io</code>. It seems the website has some hacks of its own to handle the device orientation for mobile, so this might render the orientation code obsolete (which means the game would need less code altogether).</p>
<p>Secondly, the game code still leaves a lot to be desired: it is odd, full of quick-fixes and generally very brittle. I think I will occasionally revisit this arcanoid to refactor (probably with some lightweight ECS) and update it, adding some features and whatnot.</p>
<p>Thirdly, the current version place the same sounds over and over without any pitch shifting. Adding some subtle pitch shifts would certainly make it feel less monotone.</p>
<p>Finally, like <code>macroquad</code> the game code also features some inefficiencies, which I would certainly would love to remove to re-use some parts of the code in the future. Here's a list for some of them:</p>
<ul>
<li>Frequent allocation inside <code>macroquad</code></li>
<li>Repeated <code>on_mobile</code> calls (aka repeated FFI calls)</li>
</ul>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p><a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Reference/JavaScript_interface/instantiate_static">WebAssmebly module instantiation API</a></p>
</div>
<div class="footnote-definition" id="2"><sup class="footnote-definition-label">2</sup>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation">JS orientation API</a></p>
</div>
<div class="footnote-definition" id="3"><sup class="footnote-definition-label">3</sup>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation/lock">JS orientation locking API</a></p>
</div>
<div class="footnote-definition" id="4"><sup class="footnote-definition-label">4</sup>
<p><a href="https://stackoverflow.com/questions/11381673/detecting-a-mobile-browser">A hacky regex from StackOverflow</a></p>
</div>

    </main>

        
            
    <footer class="site-footer">
        The website source code is available under the MIT license.
        All articles are available under <a href="https:&#x2F;&#x2F;creativecommons.org&#x2F;licenses&#x2F;by&#x2F;4.0&#x2F;">CC BY 4.0</a>.
        All decor (svgs in the `img/decor` directory) are designed by <a href="https://www.freepik.com">freepik.com</a>.
    </footer>

        
    </body>
</html>